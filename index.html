<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800 font-sans">

  <!-- üîπ Navbar -->
<!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πâ‡∏≤ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á body) -->
<div class="flex justify-center gap-4 py-4 bg-blue-100">
  <button id="btnDashboard" onclick="showSection('dashboard')" class="px-4 py-2 rounded">Dashboard</button>
  <button id="btnRegister" onclick="showSection('register')" class="px-4 py-2 rounded">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
</div>



<!-- Dashboard Section -->
<div id="dashboard" class="hidden p-4 max-w-5xl mx-auto">
  <h2 class="text-2xl font-bold text-center text-blue-800 mb-6">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤</h2>
  
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏° -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center mt-4">
      <div class="bg-blue-100 p-4 rounded-xl shadow-md">
        <h2 class="text-lg font-semibold text-blue-800">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <p id="totalCount" class="text-2xl font-bold text-blue-900">0</p>
      </div>
      <div class="bg-blue-100 p-4 rounded-xl shadow-md">
        <h2 class="text-lg font-semibold text-blue-800">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ä‡∏≤‡∏¢</h2>
        <p id="maleCount" class="text-2xl font-bold text-blue-900">0</p>
      </div>
      <div class="bg-blue-100 p-4 rounded-xl shadow-md">
        <h2 class="text-lg font-semibold text-blue-800">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏´‡∏ç‡∏¥‡∏á</h2>
        <p id="femaleCount" class="text-2xl font-bold text-blue-900">0</p>
      </div>
      <div class="bg-blue-100 p-4 rounded-xl shadow-md">
        <h2 class="text-lg font-semibold text-blue-800">‡∏õ‡∏µ‡∏à‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
        <p id="latestGradYear" class="text-2xl font-bold text-blue-900">-</p>
      </div>
    </div>


  <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
  <input type="text" id="searchInput" oninput="loadData()" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏™‡∏Å‡∏∏‡∏•..." class="border border-gray-300 rounded w-full p-2 mb-4">

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
  <div class="overflow-auto">
    <table class="w-full border-collapse border border-gray-300 text-sm">
      <thead class="bg-blue-200">
        <tr>
          <th class="border p-2">‡∏£‡∏´‡∏±‡∏™</th>
          <th class="border p-2">‡∏ä‡∏∑‡πà‡∏≠</th>
          <th class="border p-2">‡∏™‡∏Å‡∏∏‡∏•</th>
          <th class="border p-2">‡πÄ‡∏û‡∏®</th>
          <th class="border p-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
          <th class="border p-2">‡∏õ‡∏µ‡∏à‡∏ö</th>
          <th class="border p-2">GPA</th>
        </tr>
      </thead>
      <tbody id="alumniTableBody">
        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
      </tbody>
    </table>
  </div>
</div>


  <!-- üîπ Section: Register -->
<div id="register" class="hidden flex justify-center items-start p-4 bg-blue-50 min-h-screen">
  <div class="bg-white rounded-xl shadow-lg w-full max-w-xl p-6">
    <h2 class="text-2xl font-semibold text-center text-blue-700 mb-6">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤</h2>
    <form id="registerForm" class="space-y-4">
      <div>
        <label for="studentId" class="block font-medium">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
        <input type="text" id="studentId" name="studentId" required class="w-full border border-gray-300 rounded px-3 py-2">
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="firstName" class="block font-medium">‡∏ä‡∏∑‡πà‡∏≠</label>
          <input type="text" id="firstName" name="firstName" required class="w-full border border-gray-300 rounded px-3 py-2">
        </div>
        <div>
          <label for="lastName" class="block font-medium">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
          <input type="text" id="lastName" name="lastName" required class="w-full border border-gray-300 rounded px-3 py-2">
        </div>
      </div>
      <div>
        <label for="gender" class="block font-medium">‡πÄ‡∏û‡∏®</label>
        <select id="gender" name="gender" required class="w-full border border-gray-300 rounded px-3 py-2">
          <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏® --</option>
          <option value="‡∏ä‡∏≤‡∏¢">‡∏ä‡∏≤‡∏¢</option>
          <option value="‡∏´‡∏ç‡∏¥‡∏á">‡∏´‡∏ç‡∏¥‡∏á</option>
        </select>
      </div>
      <div>
        <label for="phone" class="block font-medium">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
        <input type="tel" id="phone" name="phone" required class="w-full border border-gray-300 rounded px-3 py-2">
      </div>
      <div>
        <label for="graduateYear" class="block font-medium">‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏û.‡∏®.)</label>
        <input type="number" id="graduateYear" name="graduateYear" required class="w-full border border-gray-300 rounded px-3 py-2">
      </div>
      <div>
        <label for="gpa" class="block font-medium">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (GPA)</label>
        <input type="number" step="0.01" id="gpa" name="gpa" required class="w-full border border-gray-300 rounded px-3 py-2">
      </div>
      <div class="text-center pt-4">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
      </div>
    </form>
  </div>
</div>


  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxZu8RMujbjmDcARWLpbZEcvj99oU77ss9xVckIYMOAMVBesHGK6cpJVjook-L90x8K/exec';

  function showSection(id) {
    document.getElementById('dashboard').classList.add('hidden');
    document.getElementById('register').classList.add('hidden');
    document.getElementById(id).classList.remove('hidden');
  }


    // üì• ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    document.getElementById('alumniForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const data = new FormData(form);

      const response = await fetch(scriptURL, {
        method: 'POST',
        body: data
      });

      if (response.ok) {
        alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
        form.reset();
        showSection('dashboard');
      } else {
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
      }
    });

    // üìä ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
async function loadData() {
  const res = await fetch(scriptURL + '?read=1');
  const data = await res.json();
  const rows = data.slice(1); // ‡∏•‡∏∞ header ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å

  const body = document.getElementById('alumniTableBody');
  const search = document.getElementById('searchInput').value.toLowerCase();
  body.innerHTML = '';

  // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
  let total = 0;
  let maleCount = 0;
  let femaleCount = 0;
  let currentGradYear = 0;

  rows.forEach(row => {
    const [id, fname, lname, gender, phone, grad, gpa] = row;
    const keyword = `${fname} ${lname}`.toLowerCase();

    if (!search || keyword.includes(search)) {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="border p-1">${id}</td>
        <td class="border p-1">${fname}</td>
        <td class="border p-1">${lname}</td>
        <td class="border p-1">${gender}</td>
        <td class="border p-1">${phone}</td>
        <td class="border p-1">${grad}</td>
        <td class="border p-1">${gpa}</td>
      `;
      body.appendChild(tr);
      total++;
    }

    // ‡∏ô‡∏±‡∏ö‡πÄ‡∏û‡∏®
    if (gender === '‡∏ä‡∏≤‡∏¢') maleCount++;
    else if (gender === '‡∏´‡∏ç‡∏¥‡∏á') femaleCount++;

    // ‡∏õ‡∏µ‡∏à‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
    if (parseInt(grad) > currentGradYear) {
      currentGradYear = parseInt(grad);
    }
  });

  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
  document.getElementById('totalCount').textContent = total;
  document.getElementById('maleCount').textContent = maleCount;
  document.getElementById('femaleCount').textContent = femaleCount;
  document.getElementById('latestGradYear').textContent = currentGradYear || "-";
}

// ‡πÇ‡∏´‡∏•‡∏î dashboard ‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
window.onload = function() {
  console.log("‡πÄ‡∏£‡∏µ‡∏¢‡∏Å showSection dashboard ‡πÅ‡∏•‡πâ‡∏ß");
  showSection('dashboard');
};

function showSection(sectionId) {
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('register').classList.add('hidden');
  
  // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å section ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  document.getElementById(sectionId).classList.remove('hidden');

  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ active ‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
  document.getElementById('btnDashboard').classList.remove('bg-blue-700', 'text-white');
  document.getElementById('btnRegister').classList.remove('bg-blue-700', 'text-white');

  if (sectionId === 'dashboard') {
    document.getElementById('btnDashboard').classList.add('bg-blue-700', 'text-white');
  } else {
    document.getElementById('btnRegister').classList.add('bg-blue-700', 'text-white');
  }
}



  </script>
</body>
</html>
